/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => StatusBarTimerPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var StatusBarTimerPlugin = class extends import_obsidian.Plugin {
  // Store the ribbon icon element
  async onload() {
    console.log("Status Bar Timer Plugin loaded!");
    this.pomodoroCount = 0;
    const statusBarContainer = this.addStatusBarItem();
    statusBarContainer.createEl("span", { text: "Timer: " });
    this.statusBarText = statusBarContainer.createEl("span", { text: "00:00:00" });
    this.pomodoroCounterText = statusBarContainer.createEl("span", { text: " \u{1F345} 0" });
    this.startButton = statusBarContainer.createEl("button", { text: "Start" });
    this.startButton.addEventListener("click", () => this.startTimer());
    this.stopButton = statusBarContainer.createEl("button", { text: "Stop" });
    this.stopButton.addEventListener("click", () => this.stopTimer());
    this.stopButton.disabled = true;
    this.zenButton = statusBarContainer.createEl("button", { text: "Zen" });
    this.zenButton.addEventListener("click", () => this.toggleZenMode());
    this.ribbonIcon = this.addRibbonIcon("timer", "Start Pomodoro", () => this.openPomodoroModal());
    this.isRunning = false;
    this.pomodoroTime = 0;
    this.isZenMode = false;
  }
  startTimer() {
    if (this.isRunning)
      return;
    this.startTime = Date.now();
    this.timerInterval = window.setInterval(() => this.updateTimer(), 1e3);
    this.isRunning = true;
    this.startButton.disabled = true;
    this.stopButton.disabled = false;
  }
  stopTimer() {
    if (!this.isRunning)
      return;
    window.clearInterval(this.timerInterval);
    this.isRunning = false;
    this.startButton.disabled = false;
    this.stopButton.disabled = true;
  }
  updateTimer() {
    const elapsedTime = Date.now() - this.startTime;
    const formattedTime = this.formatTime(elapsedTime);
    this.statusBarText.setText(formattedTime);
  }
  formatTime(milliseconds) {
    const totalSeconds = Math.floor(milliseconds / 1e3);
    const hours = Math.floor(totalSeconds / 3600);
    const minutes = Math.floor(totalSeconds % 3600 / 60);
    const seconds = totalSeconds % 60;
    return `${String(hours).padStart(2, "0")}:${String(minutes).padStart(2, "0")}:${String(seconds).padStart(2, "0")}`;
  }
  toggleZenMode() {
    this.isZenMode = !this.isZenMode;
    if (this.isZenMode) {
      this.storeSplitsValues();
      this.collapseSplits();
      this.zenButton.setText("Normal");
    } else {
      this.restoreSplits();
      this.zenButton.setText("Zen");
    }
  }
  storeSplitsValues() {
    this.leftSplitCollapsed = this.app.workspace.leftSplit.collapsed;
    this.rightSplitCollapsed = this.app.workspace.rightSplit.collapsed;
  }
  collapseSplits() {
    this.app.workspace.leftSplit.collapse();
    this.app.workspace.rightSplit.collapse();
  }
  restoreSplits() {
    if (!this.leftSplitCollapsed) {
      this.app.workspace.leftSplit.expand();
    }
    if (!this.rightSplitCollapsed) {
      this.app.workspace.rightSplit.expand();
    }
  }
  openPomodoroModal() {
    const modal = new PomodoroModal(this.app, (time) => this.startPomodoro(time));
    modal.open();
  }
  startPomodoro(time) {
    this.pomodoroTime = time * 60 * 1e3;
    const endTime = Date.now() + this.pomodoroTime;
    this.pomodoroInterval = window.setInterval(() => {
      const remainingTime = endTime - Date.now();
      if (remainingTime <= 0) {
        this.stopPomodoro();
        this.incrementPomodoroCounter();
        new import_obsidian.Notice("\u0418\u043D\u0442\u0435\u0440\u0432\u0430\u043B \u0437\u0430\u043A\u043E\u043D\u0447\u0438\u043B\u0441\u044F. \u041C\u043E\u0436\u043D\u043E \u0432\u044B\u0439\u0442\u0438 \u043F\u043E\u043A\u0443\u0440\u0438\u0442\u044C");
        window.clearInterval(this.pomodoroInterval);
      } else {
        this.statusBarText.setText(this.formatTime(remainingTime));
      }
    }, 1e3);
  }
  stopPomodoro() {
    window.clearInterval(this.pomodoroInterval);
    this.statusBarText.setText("00:00:00");
  }
  incrementPomodoroCounter() {
    this.pomodoroCount++;
    this.pomodoroCounterText.setText(` \u{1F345} ${this.pomodoroCount}`);
  }
  onunload() {
    console.log("Status Bar Timer Plugin unloaded!");
    window.clearInterval(this.timerInterval);
    window.clearInterval(this.pomodoroInterval);
    if (this.isZenMode) {
      this.restoreSplits();
    }
    if (this.ribbonIcon) {
      this.ribbonIcon.remove();
    }
  }
};
var PomodoroModal = class extends import_obsidian.Modal {
  constructor(app, onSubmit) {
    super(app);
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h2", { text: "Pomodoro Timer" });
    const timeSelect = contentEl.createEl("select");
    timeSelect.createEl("option", { value: "5", text: "5 \u043C\u0438\u043D\u0443\u0442" });
    timeSelect.createEl("option", { value: "10", text: "10 \u043C\u0438\u043D\u0443\u0442" });
    timeSelect.createEl("option", { value: "25", text: "25 \u043C\u0438\u043D\u0443\u0442" });
    timeSelect.createEl("option", { value: "45", text: "45 \u043C\u0438\u043D\u0443\u0442" });
    timeSelect.createEl("option", { value: "0.8", text: "\u0422\u0435\u0441\u0442 \u0434\u043B\u044F \u043F\u043E\u043A\u0430\u0437\u0430 \u0443\u0432\u0435\u0434\u043E\u043C\u043B\u0435\u043D\u0438\u044F" });
    const startButton = contentEl.createEl("button", { text: "Start" });
    startButton.addEventListener("click", () => {
      const selectedTime = parseInt(timeSelect.value);
      this.onSubmit(selectedTime);
      this.close();
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBOb3RpY2UsIE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTdGF0dXNCYXJUaW1lclBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gIHN0YXR1c0JhclRleHQ6IEhUTUxFbGVtZW50O1xuICBwb21vZG9yb0NvdW50ZXJUZXh0OiBIVE1MRWxlbWVudDtcbiAgc3RhcnRCdXR0b246IEhUTUxCdXR0b25FbGVtZW50O1xuICBzdG9wQnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudDtcbiAgemVuQnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudDtcbiAgdGltZXJJbnRlcnZhbDogbnVtYmVyO1xuICBzdGFydFRpbWU6IG51bWJlcjtcbiAgaXNSdW5uaW5nOiBib29sZWFuO1xuICBwb21vZG9yb0ludGVydmFsOiBudW1iZXI7XG4gIHBvbW9kb3JvVGltZTogbnVtYmVyO1xuICBpc1plbk1vZGU6IGJvb2xlYW47XG4gIGxlZnRTcGxpdENvbGxhcHNlZDogYm9vbGVhbjtcbiAgcmlnaHRTcGxpdENvbGxhcHNlZDogYm9vbGVhbjtcbiAgcG9tb2Rvcm9Db3VudDogbnVtYmVyO1xuICByaWJib25JY29uOiBIVE1MRWxlbWVudDsgLy8gU3RvcmUgdGhlIHJpYmJvbiBpY29uIGVsZW1lbnRcblxuICBhc3luYyBvbmxvYWQoKSB7XG4gICAgY29uc29sZS5sb2coJ1N0YXR1cyBCYXIgVGltZXIgUGx1Z2luIGxvYWRlZCEnKTtcblxuICAgIC8vIEluaXRpYWxpemUgUG9tb2Rvcm8gY291bnRlclxuICAgIHRoaXMucG9tb2Rvcm9Db3VudCA9IDA7XG5cbiAgICAvLyBDcmVhdGUgYSBjb250YWluZXIgZm9yIHRoZSBzdGF0dXMgYmFyIGVsZW1lbnRzXG4gICAgY29uc3Qgc3RhdHVzQmFyQ29udGFpbmVyID0gdGhpcy5hZGRTdGF0dXNCYXJJdGVtKCk7XG4gICAgc3RhdHVzQmFyQ29udGFpbmVyLmNyZWF0ZUVsKCdzcGFuJywgeyB0ZXh0OiAnVGltZXI6ICcgfSk7XG5cbiAgICAvLyBBZGQgdGhlIHRpbWVyIGRpc3BsYXlcbiAgICB0aGlzLnN0YXR1c0JhclRleHQgPSBzdGF0dXNCYXJDb250YWluZXIuY3JlYXRlRWwoJ3NwYW4nLCB7IHRleHQ6ICcwMDowMDowMCcgfSk7XG5cbiAgICAvLyBBZGQgdGhlIFBvbW9kb3JvIGNvdW50ZXIgZGlzcGxheSAodG9tYXRvIGVtb2ppKVxuICAgIHRoaXMucG9tb2Rvcm9Db3VudGVyVGV4dCA9IHN0YXR1c0JhckNvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogJyBcdUQ4M0NcdURGNDUgMCcgfSk7XG5cbiAgICAvLyBBZGQgYSBTdGFydCBidXR0b25cbiAgICB0aGlzLnN0YXJ0QnV0dG9uID0gc3RhdHVzQmFyQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdTdGFydCcgfSkgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgdGhpcy5zdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuc3RhcnRUaW1lcigpKTtcblxuICAgIC8vIEFkZCBhIFN0b3AgYnV0dG9uXG4gICAgdGhpcy5zdG9wQnV0dG9uID0gc3RhdHVzQmFyQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdTdG9wJyB9KSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICB0aGlzLnN0b3BCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLnN0b3BUaW1lcigpKTtcbiAgICB0aGlzLnN0b3BCdXR0b24uZGlzYWJsZWQgPSB0cnVlOyAvLyBEaXNhYmxlIFN0b3AgYnV0dG9uIGluaXRpYWxseVxuXG4gICAgLy8gQWRkIGEgWmVuIGJ1dHRvblxuICAgIHRoaXMuemVuQnV0dG9uID0gc3RhdHVzQmFyQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdaZW4nIH0pIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHRoaXMuemVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy50b2dnbGVaZW5Nb2RlKCkpO1xuXG4gICAgLy8gQWRkIGEgUG9tb2Rvcm8gYnV0dG9uIHRvIHRoZSBzaWRlYmFyIChyaWJib24gaWNvbilcbiAgICB0aGlzLnJpYmJvbkljb24gPSB0aGlzLmFkZFJpYmJvbkljb24oJ3RpbWVyJywgJ1N0YXJ0IFBvbW9kb3JvJywgKCkgPT4gdGhpcy5vcGVuUG9tb2Rvcm9Nb2RhbCgpKTtcbiAgICAvLyBJbml0aWFsaXplIHN0YXRlc1xuICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgdGhpcy5wb21vZG9yb1RpbWUgPSAwO1xuICAgIHRoaXMuaXNaZW5Nb2RlID0gZmFsc2U7XG4gIH1cblxuICBzdGFydFRpbWVyKCkge1xuICAgIGlmICh0aGlzLmlzUnVubmluZykgcmV0dXJuOyAvLyBUaW1lciBpcyBhbHJlYWR5IHJ1bm5pbmdcblxuICAgIHRoaXMuc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLnRpbWVySW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy51cGRhdGVUaW1lcigpLCAxMDAwKTtcbiAgICB0aGlzLmlzUnVubmluZyA9IHRydWU7XG5cbiAgICAvLyBVcGRhdGUgYnV0dG9uIHN0YXRlc1xuICAgIHRoaXMuc3RhcnRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIHRoaXMuc3RvcEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgc3RvcFRpbWVyKCkge1xuICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHJldHVybjsgLy8gVGltZXIgaXMgbm90IHJ1bm5pbmdcblxuICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMudGltZXJJbnRlcnZhbCk7XG4gICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTtcblxuICAgIC8vIFVwZGF0ZSBidXR0b24gc3RhdGVzXG4gICAgdGhpcy5zdGFydEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMuc3RvcEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICB1cGRhdGVUaW1lcigpIHtcbiAgICBjb25zdCBlbGFwc2VkVGltZSA9IERhdGUubm93KCkgLSB0aGlzLnN0YXJ0VGltZTtcbiAgICBjb25zdCBmb3JtYXR0ZWRUaW1lID0gdGhpcy5mb3JtYXRUaW1lKGVsYXBzZWRUaW1lKTtcbiAgICB0aGlzLnN0YXR1c0JhclRleHQuc2V0VGV4dChmb3JtYXR0ZWRUaW1lKTtcbiAgfVxuXG4gIGZvcm1hdFRpbWUobWlsbGlzZWNvbmRzOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGNvbnN0IHRvdGFsU2Vjb25kcyA9IE1hdGguZmxvb3IobWlsbGlzZWNvbmRzIC8gMTAwMCk7XG4gICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKHRvdGFsU2Vjb25kcyAvIDM2MDApO1xuICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKCh0b3RhbFNlY29uZHMgJSAzNjAwKSAvIDYwKTtcbiAgICBjb25zdCBzZWNvbmRzID0gdG90YWxTZWNvbmRzICUgNjA7XG4gICAgcmV0dXJuIGAke1N0cmluZyhob3VycykucGFkU3RhcnQoMiwgJzAnKX06JHtTdHJpbmcobWludXRlcykucGFkU3RhcnQoMiwgJzAnKX06JHtTdHJpbmcoc2Vjb25kcykucGFkU3RhcnQoMiwgJzAnKX1gO1xuICB9XG5cbiAgdG9nZ2xlWmVuTW9kZSgpIHtcbiAgICB0aGlzLmlzWmVuTW9kZSA9ICF0aGlzLmlzWmVuTW9kZTtcblxuICAgIGlmICh0aGlzLmlzWmVuTW9kZSkge1xuICAgICAgLy8gRW50ZXIgWmVuIG1vZGU6IENvbGxhcHNlIHNpZGViYXJzXG4gICAgICB0aGlzLnN0b3JlU3BsaXRzVmFsdWVzKCk7XG4gICAgICB0aGlzLmNvbGxhcHNlU3BsaXRzKCk7XG4gICAgICB0aGlzLnplbkJ1dHRvbi5zZXRUZXh0KCdOb3JtYWwnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRXhpdCBaZW4gbW9kZTogUmVzdG9yZSBzaWRlYmFyc1xuICAgICAgdGhpcy5yZXN0b3JlU3BsaXRzKCk7XG4gICAgICB0aGlzLnplbkJ1dHRvbi5zZXRUZXh0KCdaZW4nKTtcbiAgICB9XG4gIH1cblxuICBzdG9yZVNwbGl0c1ZhbHVlcygpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgdGhpcy5sZWZ0U3BsaXRDb2xsYXBzZWQgPSB0aGlzLmFwcC53b3Jrc3BhY2UubGVmdFNwbGl0LmNvbGxhcHNlZDtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgdGhpcy5yaWdodFNwbGl0Q29sbGFwc2VkID0gdGhpcy5hcHAud29ya3NwYWNlLnJpZ2h0U3BsaXQuY29sbGFwc2VkO1xuICB9XG5cbiAgY29sbGFwc2VTcGxpdHMoKSB7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5sZWZ0U3BsaXQuY29sbGFwc2UoKTtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgdGhpcy5hcHAud29ya3NwYWNlLnJpZ2h0U3BsaXQuY29sbGFwc2UoKTtcbiAgfVxuXG4gIHJlc3RvcmVTcGxpdHMoKSB7XG4gICAgaWYgKCF0aGlzLmxlZnRTcGxpdENvbGxhcHNlZCkge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgdGhpcy5hcHAud29ya3NwYWNlLmxlZnRTcGxpdC5leHBhbmQoKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMucmlnaHRTcGxpdENvbGxhcHNlZCkge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnJpZ2h0U3BsaXQuZXhwYW5kKCk7XG4gICAgfVxuICB9XG5cbiAgb3BlblBvbW9kb3JvTW9kYWwoKSB7XG4gICAgLy8gQ3JlYXRlIGEgbW9kYWwgZm9yIFBvbW9kb3JvIHNldHRpbmdzXG4gICAgY29uc3QgbW9kYWwgPSBuZXcgUG9tb2Rvcm9Nb2RhbCh0aGlzLmFwcCwgKHRpbWU6IG51bWJlcikgPT4gdGhpcy5zdGFydFBvbW9kb3JvKHRpbWUpKTtcbiAgICBtb2RhbC5vcGVuKCk7XG4gIH1cblxuICBzdGFydFBvbW9kb3JvKHRpbWU6IG51bWJlcikge1xuICAgIHRoaXMucG9tb2Rvcm9UaW1lID0gdGltZSAqIDYwICogMTAwMDsgLy8gQ29udmVydCBtaW51dGVzIHRvIG1pbGxpc2Vjb25kc1xuICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpICsgdGhpcy5wb21vZG9yb1RpbWU7XG5cbiAgICAvLyBVcGRhdGUgdGhlIHRpbWVyIGRpc3BsYXkgZXZlcnkgc2Vjb25kXG4gICAgdGhpcy5wb21vZG9yb0ludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGNvbnN0IHJlbWFpbmluZ1RpbWUgPSBlbmRUaW1lIC0gRGF0ZS5ub3coKTtcbiAgICAgIGlmIChyZW1haW5pbmdUaW1lIDw9IDApIHtcbiAgICAgICAgdGhpcy5zdG9wUG9tb2Rvcm8oKTtcbiAgICAgICAgdGhpcy5pbmNyZW1lbnRQb21vZG9yb0NvdW50ZXIoKTtcblx0XHRuZXcgTm90aWNlKCdcdTA0MThcdTA0M0RcdTA0NDJcdTA0MzVcdTA0NDBcdTA0MzJcdTA0MzBcdTA0M0IgXHUwNDM3XHUwNDMwXHUwNDNBXHUwNDNFXHUwNDNEXHUwNDQ3XHUwNDM4XHUwNDNCXHUwNDQxXHUwNDRGLiBcdTA0MUNcdTA0M0VcdTA0MzZcdTA0M0RcdTA0M0UgXHUwNDMyXHUwNDRCXHUwNDM5XHUwNDQyXHUwNDM4IFx1MDQzRlx1MDQzRVx1MDQzQVx1MDQ0M1x1MDQ0MFx1MDQzOFx1MDQ0Mlx1MDQ0QycpO1xuXHRcdHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMucG9tb2Rvcm9JbnRlcnZhbCk7IC8vIENsZWFyIHRoZSBpbnRlcnZhbFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zdGF0dXNCYXJUZXh0LnNldFRleHQodGhpcy5mb3JtYXRUaW1lKHJlbWFpbmluZ1RpbWUpKTtcbiAgICAgIH1cbiAgICB9LCAxMDAwKTtcbiAgfVxuXG4gIHN0b3BQb21vZG9ybygpIHtcbiAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLnBvbW9kb3JvSW50ZXJ2YWwpO1xuICAgIHRoaXMuc3RhdHVzQmFyVGV4dC5zZXRUZXh0KCcwMDowMDowMCcpO1xuICB9XG5cbiAgaW5jcmVtZW50UG9tb2Rvcm9Db3VudGVyKCkge1xuICAgIHRoaXMucG9tb2Rvcm9Db3VudCsrO1xuICAgIHRoaXMucG9tb2Rvcm9Db3VudGVyVGV4dC5zZXRUZXh0KGAgXHVEODNDXHVERjQ1ICR7dGhpcy5wb21vZG9yb0NvdW50fWApO1xuICB9XG5cbiAgb251bmxvYWQoKSB7XG4gICAgY29uc29sZS5sb2coJ1N0YXR1cyBCYXIgVGltZXIgUGx1Z2luIHVubG9hZGVkIScpO1xuICAgIC8vIENsZWFyIHRoZSBpbnRlcnZhbCB3aGVuIHRoZSBwbHVnaW4gaXMgdW5sb2FkZWRcbiAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVySW50ZXJ2YWwpO1xuICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMucG9tb2Rvcm9JbnRlcnZhbCk7XG5cbiAgICAvLyBFbnN1cmUgc2lkZWJhcnMgYXJlIHJlc3RvcmVkIHdoZW4gdGhlIHBsdWdpbiBpcyB1bmxvYWRlZFxuICAgIGlmICh0aGlzLmlzWmVuTW9kZSkge1xuICAgICAgdGhpcy5yZXN0b3JlU3BsaXRzKCk7XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIHRoZSByaWJib24gaWNvbiB3aGVuIHRoZSBwbHVnaW4gaXMgdW5sb2FkZWRcbiAgICBpZiAodGhpcy5yaWJib25JY29uKSB7XG4gICAgICB0aGlzLnJpYmJvbkljb24ucmVtb3ZlKCk7XG4gICAgfVxuICB9XG59XG5cbmNsYXNzIFBvbW9kb3JvTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIG9uU3VibWl0OiAodGltZTogbnVtYmVyKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKGFwcDogaW1wb3J0KCdvYnNpZGlhbicpLkFwcCwgb25TdWJtaXQ6ICh0aW1lOiBudW1iZXIpID0+IHZvaWQpIHtcbiAgICBzdXBlcihhcHApO1xuICAgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcbiAgfVxuXG4gIG9uT3BlbigpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdQb21vZG9ybyBUaW1lcicgfSk7XG5cbiAgICAvLyBBZGQgYSBkcm9wZG93biBmb3Igc2VsZWN0aW5nIHRoZSBjb3VudGRvd24gdGltZVxuICAgIGNvbnN0IHRpbWVTZWxlY3QgPSBjb250ZW50RWwuY3JlYXRlRWwoJ3NlbGVjdCcpO1xuXHR0aW1lU2VsZWN0LmNyZWF0ZUVsKCdvcHRpb24nLCB7IHZhbHVlOiAnNScsIHRleHQ6ICc1IFx1MDQzQ1x1MDQzOFx1MDQzRFx1MDQ0M1x1MDQ0MicgfSk7XG5cdHRpbWVTZWxlY3QuY3JlYXRlRWwoJ29wdGlvbicsIHsgdmFsdWU6ICcxMCcsIHRleHQ6ICcxMCBcdTA0M0NcdTA0MzhcdTA0M0RcdTA0NDNcdTA0NDInIH0pO1xuXHR0aW1lU2VsZWN0LmNyZWF0ZUVsKCdvcHRpb24nLCB7IHZhbHVlOiAnMjUnLCB0ZXh0OiAnMjUgXHUwNDNDXHUwNDM4XHUwNDNEXHUwNDQzXHUwNDQyJyB9KTtcblx0dGltZVNlbGVjdC5jcmVhdGVFbCgnb3B0aW9uJywgeyB2YWx1ZTogJzQ1JywgdGV4dDogJzQ1IFx1MDQzQ1x1MDQzOFx1MDQzRFx1MDQ0M1x1MDQ0MicgfSk7XG5cdHRpbWVTZWxlY3QuY3JlYXRlRWwoJ29wdGlvbicsIHsgdmFsdWU6ICcwLjgnLCB0ZXh0OiAnXHUwNDIyXHUwNDM1XHUwNDQxXHUwNDQyIFx1MDQzNFx1MDQzQlx1MDQ0RiBcdTA0M0ZcdTA0M0VcdTA0M0FcdTA0MzBcdTA0MzdcdTA0MzAgXHUwNDQzXHUwNDMyXHUwNDM1XHUwNDM0XHUwNDNFXHUwNDNDXHUwNDNCXHUwNDM1XHUwNDNEXHUwNDM4XHUwNDRGJ30pO1xuXG4gICAgLy8gQWRkIGEgc3RhcnQgYnV0dG9uXG4gICAgY29uc3Qgc3RhcnRCdXR0b24gPSBjb250ZW50RWwuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ1N0YXJ0JyB9KTtcbiAgICBzdGFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IHNlbGVjdGVkVGltZSA9IHBhcnNlSW50KHRpbWVTZWxlY3QudmFsdWUpO1xuICAgICAgdGhpcy5vblN1Ym1pdChzZWxlY3RlZFRpbWUpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgb25DbG9zZSgpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBc0M7QUFFdEMsSUFBcUIsdUJBQXJCLGNBQWtELHVCQUFPO0FBQUE7QUFBQSxFQWlCdkQsTUFBTSxTQUFTO0FBQ2IsWUFBUSxJQUFJLGlDQUFpQztBQUc3QyxTQUFLLGdCQUFnQjtBQUdyQixVQUFNLHFCQUFxQixLQUFLLGlCQUFpQjtBQUNqRCx1QkFBbUIsU0FBUyxRQUFRLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFHdkQsU0FBSyxnQkFBZ0IsbUJBQW1CLFNBQVMsUUFBUSxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBRzdFLFNBQUssc0JBQXNCLG1CQUFtQixTQUFTLFFBQVEsRUFBRSxNQUFNLGVBQVEsQ0FBQztBQUdoRixTQUFLLGNBQWMsbUJBQW1CLFNBQVMsVUFBVSxFQUFFLE1BQU0sUUFBUSxDQUFDO0FBQzFFLFNBQUssWUFBWSxpQkFBaUIsU0FBUyxNQUFNLEtBQUssV0FBVyxDQUFDO0FBR2xFLFNBQUssYUFBYSxtQkFBbUIsU0FBUyxVQUFVLEVBQUUsTUFBTSxPQUFPLENBQUM7QUFDeEUsU0FBSyxXQUFXLGlCQUFpQixTQUFTLE1B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
